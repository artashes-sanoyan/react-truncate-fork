/**
 * name: react-truncate-fork
 * version: v0.4.3
 * description: Provides `Truncate`, `MiddleTruncate` and `ShowMore` React components for truncating multi-line spans and adding an ellipsis.
 * author: chengpeiquan <chengpeiquan@chengpeiquan.com>
 * homepage: https://truncate.js.org
 * license: MIT
 */
"use strict";var se=Object.create;var z=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var ae=Object.getPrototypeOf,ce=Object.prototype.hasOwnProperty;var pe=(e,t)=>{for(var r in t)z(e,r,{get:t[r],enumerable:!0})},Z=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of le(t))!ce.call(e,s)&&s!==r&&z(e,s,{get:()=>t[s],enumerable:!(o=ie(t,s))||o.enumerable});return e};var B=(e,t,r)=>(r=e!=null?se(ae(e)):{},Z(t||!e||!e.__esModule?z(r,"default",{value:e,enumerable:!0}):r,e)),ue=e=>Z(z({},"__esModule",{value:!0}),e);var fe={};pe(fe,{MiddleTruncate:()=>re,ShowMore:()=>oe,Truncate:()=>J});module.exports=ue(fe);var n=B(require("react"),1);var D=B(require("react"),1),_=e=>e?.offsetWidth,O=e=>e.replace(/\s+$/,""),ee=(e,t,r)=>{if(t===r.length-1)return D.default.createElement("span",{key:t},e);{let o=D.default.createElement("br",{key:`${t}br`});return e?[D.default.createElement("span",{key:t},e),o]:o}},te=(e,t)=>{let r=document.createElement("div"),o="innerText"in window.HTMLElement.prototype?"innerText":"textContent";r.innerHTML=e?.innerHTML.replace(/\r\n|\r|\n/g,t)||"";let s=r[o],a=document.createElement("div");return a.innerHTML="foo<br/>bar",a[o]?.replace(/\r\n|\r/g,`
`)!==`foo
bar`&&(r.innerHTML=r.innerHTML.replace(/<br.*?[/]?>/gi,`
`),s=r[o]),s||""},ne=({end:e,lastLineText:t,fullText:r,targetWidth:o,ellipsisWidth:s,measureWidth:a})=>{let u=t.length,T=Math.abs(e),c=T>u?0:u-T,f=t.slice(0,c),m=c===0?-u:e,w=r.slice(m),H=a(f)+a(w)+s;for(;H>o;)f=f.slice(0,f.length-1),H=a(f)+a(w)+s;return{startFragment:f,endFragment:w}};var J=({children:e,ellipsis:t="...",lines:r=1,trimWhitespace:o=!1,width:s=0,separator:a=" ",middle:u=!1,end:T=5,onTruncate:c,...f})=>{let[m,w]=(0,n.useState)(),[H,N]=(0,n.useState)(),[h,S]=(0,n.useState)(0),[X,V]=(0,n.useState)(0),b=(0,n.useRef)(null),d=(0,n.useRef)(null),E=(0,n.useRef)(null);(0,n.useEffect)(()=>{d&&d.current&&d.current.parentNode&&d.current.parentNode.removeChild(d.current)},[h]);let v=(0,n.useCallback)(()=>{if(!b.current?.parentElement)return;let i=s||Math.floor(b.current.parentElement.getBoundingClientRect().width);if(!i)return window.requestAnimationFrame(()=>v());let p=window.getComputedStyle(b.current),W=[p.fontWeight,p.fontStyle,p.fontSize,p.fontFamily].join(" ");m&&(m.font=W,m.letterSpacing=p.letterSpacing),S(i)},[m,s]);(0,n.useEffect)(()=>{let i=document.createElement("canvas");w(i.getContext("2d"))},[]),(0,n.useEffect)(()=>(v(),window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v),window.cancelAnimationFrame(X)}),[v,X]);let I=(0,n.useCallback)(i=>{typeof c=="function"&&V(window.requestAnimationFrame(()=>{c(i)}))},[c]),A=(0,n.useCallback)(i=>m?.measureText(i).width||0,[m]),K=(0,n.useMemo)(()=>!Number.isSafeInteger(r)||r<0?0:r,[r]),R=(0,n.useMemo)(()=>u?1:K,[K,u]),q=(0,n.useMemo)(()=>{let i=Math.abs(T),p=Number.isFinite(i)?Math.floor(i):0;return p>0?-p:p},[T]),Q=(0,n.useCallback)(()=>{let i=[],p=te(d.current,a),W=p.split(`
`).map(F=>F.split(a)),U=_(E.current)||0,Y=!0;for(let F=1;F<=R;F++){let k=W[0];if(k.length===0){i.push(),W.shift(),F--;continue}let j=k.join(a)||"";if(A(j)<=h&&W.length===1){Y=!1,i.push(j);break}if(F===R){let x=k.join(a),y=0,C=x.length-1;for(;y<=C;){let M=Math.floor((y+C)/2),G=x.slice(0,M+1);A(G)+U<=h?y=M+1:C=M-1}let L=x.slice(0,y);if(o)for(L=O(L);!L.length&&i.length;){let M=i.pop();M&&typeof M=="string"&&(L=O(M))}if(u&&q!==0){let{startFragment:M,endFragment:G}=ne({end:q,lastLineText:L,fullText:p,targetWidth:h,ellipsisWidth:U,measureWidth:A});j=n.default.createElement("span",null,M,t,G)}else j=n.default.createElement("span",null,L,t)}else{let x=0,y=k.length-1;for(;x<=y;){let C=Math.floor((x+y)/2),L=k.slice(0,C+1).join(a);A(L)<=h?x=C+1:y=C-1}if(x===0){F=R-1;continue}j=k.slice(0,x).join(a),W[0].splice(0,x)}i.push(j)}return I(Y),i},[a,I,R,A,h,o,q,u,t]);return(0,n.useEffect)(()=>{let i=!!(b.current&&h);typeof window<"u"&&i&&(R>0?N(Q().map(ee)):(N(e),I(!1)))},[e,R,h,Q,I]),n.default.createElement("span",{...f,ref:b},n.default.createElement("span",null,H),n.default.createElement("span",{ref:d},e),n.default.createElement("span",{ref:E,style:{position:"fixed",visibility:"hidden",top:0,left:0}},t))};var g=B(require("react"),1);var re=(0,g.forwardRef)(({children:e,onTruncate:t,...r},o)=>{let{width:s,middle:a,lines:u,...T}=r,[c,f]=(0,g.useState)(!1),m=(0,g.useCallback)(w=>{w!==c&&f(w)},[c]);return(0,g.useEffect)(()=>{typeof t=="function"&&t(c)},[t,c]),g.default.createElement("div",{ref:o,style:{width:"100%"}},g.default.createElement(J,{...T,middle:!0,onTruncate:m},e))});re.displayName="MiddleTruncate";var l=B(require("react"),1);var P=B(require("react"),1),$=({type:e,label:t,className:r,toggleLines:o})=>{let s=(0,P.useMemo)(()=>e==="more"?"... ":" ",[e]);return(0,P.isValidElement)(t)?t:P.default.createElement("span",null,s,P.default.createElement("a",{href:"#",className:r,onClick:o},t))};var oe=(0,l.forwardRef)(({lines:e=3,more:t="Expand",less:r="Collapse",anchorClass:o,onToggle:s,children:a,...u},T)=>{let{width:c,middle:f,end:m,ellipsis:w,...H}=u,[N,h]=(0,l.useState)(!1),[S,X]=(0,l.useState)(!1),V=(0,l.useMemo)(()=>S?0:e,[S,e]),b=(0,l.useCallback)(E=>{E!==N&&h(E)},[N]),d=(0,l.useCallback)(E=>{E.preventDefault(),X(v=>!v)},[]);return(0,l.useImperativeHandle)(T,()=>({toggleLines:d})),(0,l.useEffect)(()=>{typeof s=="function"&&s(S)},[S,s]),l.default.createElement("div",{style:{width:"100%"}},l.default.createElement(J,{...H,lines:V,ellipsis:l.default.createElement($,{type:"more",label:t,className:o,toggleLines:d}),onTruncate:b},a),!N&&S&&l.default.createElement($,{type:"less",label:r,className:o,toggleLines:d}))});oe.displayName="ShowMore";0&&(module.exports={MiddleTruncate,ShowMore,Truncate});
